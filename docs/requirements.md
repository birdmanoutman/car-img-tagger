# 汽车图片智能标签系统 - 项目需求文档

## 1. 项目概述

### 1.1 项目背景
本项目旨在构建一个基于AI技术的智能汽车图片标注系统，实现从数据预处理到智能标注再到Web管理的全流程自动化。

### 1.2 项目目标
- **提升效率**: 通过AI自动标注，将标注效率提升10倍以上
- **降低成本**: 减少95%的人工标注成本
- **保证质量**: 通过AI+主动学习审核，确保核心标签准确率达到95%以上
- **精准细分**: 强化内饰关键部件（换挡球头、模式旋钮等）的识别能力
- **易于使用**: 提供直观的Web界面，降低技术使用门槛
- **可扩展性**: 支持新品牌、新标签类型的快速扩展

### 1.3 应用场景
- 汽车设计公司的图片资源管理
- 汽车媒体的内容分类
- 学术研究的数据集构建

## 2. 功能需求

### 2.1 核心功能需求

#### 2.1.1 智能图片标注
**需求描述**: 系统应能够自动识别汽车图片的多维度特征并生成相应标签

**功能要求**:
- 支持24种汽车角度标签识别（前45°、正侧、后45°、正前、正后、头灯、尾灯、格栅、轮毂、内饰、方向盘、中控屏、CONSOLE、座椅、门板、旋钮、球头、天窗、后备箱、前备箱、出风口、仪表屏、扩散器、C柱、充电口）
- 支持8个主要汽车品牌识别（Cadillac、Ferrari、Honda、MINI、Nissan、Porsche、Smart、Toyota）
- 支持16种设计风格识别（新能源、运动、豪华、概念车、复古、现代、经典、未来感、商务、家用、越野、跑车、SUV、轿车、掀背车、敞篷车）
- 支持15种车身颜色识别（黑、白、银、灰、红、蓝、绿、黄、橙、紫、棕、金、香槟、珍珠白、金属漆）
- 支持8类内饰关键部件识别（方向盘细节、换挡球头、换挡杆、中控旋钮、空调出风口、座椅、门板饰条、驾驶模式旋钮）

**性能指标**:
- 单张图片处理时间 ≤ 1秒
- 角度识别准确率 ≥ 95%
- 品牌识别准确率 ≥ 90%
- 风格识别准确率 ≥ 85%
- 颜色识别准确率 ≥ 95%
- 内饰部件识别准确率 ≥ 85%，召回率 ≥ 80%

#### 2.1.2 半自动标注流水线
**需求描述**: 建立AI预标注+人工审核的半自动化标注工作流

**功能要求**:
- AI自动预标注功能
- 置信度与不确定性评分机制（基于熵/边际）
- 主动学习策略：低置信度结果自动进入人工审核队列
- 支持批次管理和质量控制
- 集成Label Studio标注工具
- 支持标注历史追踪和版本控制

**业务流程**:
1. 图片批量导入
2. AI模型自动预标注
3. 置信度评分和筛选
4. 主动学习队列生成（低置信度样本推送到Label Studio）
5. 高置信度结果直接入库
6. 人工审核和修正
7. 最终结果入库

#### 2.1.3 数据管理系统
**需求描述**: 提供完整的图片和标签数据管理功能

**功能要求**:
- 图片信息管理（路径、尺寸、文件大小、创建时间等）
- 标签体系管理（角度、品牌、风格、颜色等多维度标签）
- 图片-标签关联管理（多对多关系，支持置信度）
- 标注历史记录（操作用户、时间、变更内容）
- 数据统计和分析功能
- 支持数据导入导出（CSV、JSON格式）

**数据库设计**:
- images表：存储图片基本信息
- tags表：存储标签定义
- image_tags表：存储图片标签关联关系
- annotation_history表：存储标注历史记录

#### 2.1.4 Web管理界面
**需求描述**: 提供用户友好的图片浏览、搜索、管理界面

**功能要求**:
- 图片网格展示（支持缩略图）
- 多维度搜索筛选（品牌、角度、风格、颜色、年份等）
- 标签管理和编辑功能
- 批量操作支持（批量标注、批量导出等）
- 统计信息展示（数量分布、标注进度等）
- 响应式设计（支持PC和移动设备）

**页面设计**:
- 首页：系统概览和统计信息
- 图片浏览：网格展示和筛选功能
- 搜索页面：高级搜索功能
- 标签管理：标签编辑和维护
- 统计分析：数据可视化展示

#### 2.1.5 高性能推理管线
**需求描述**: 在NVIDIA A5000 GPU环境下保障高吞吐量推理

**功能要求**:
- 视觉语言骨干支持ONNX/TensorRT导出，默认启用FP16
- 支持批量推理与任务队列（≥64张/批）
- 处理耗时、GPU显存等关键指标可观测
- 与Web/API解耦的异步推理模式，保障前台响应
- 可切换轻量级蒸馏模型作为实时预测备用方案

### 2.2 扩展功能需求

#### 2.2.1 高级AI模型训练
**需求描述**: 支持SigLIP骨干的轻量微调与持续学习

**功能要求**:
- 提供LoRA/Adapter等参数高效微调策略
- 训练脚本支持内饰关键部件的专用子集与难例挖掘
- 支持强增强（颜色抖动、透视变化）和均衡采样
- 输出训练曲线、混淆矩阵与标签分布可视化
- 支持模型集成与知识蒸馏生成轻量推理模型
- 与主动学习队列打通，实现闭环迭代

#### 2.2.2 颜色检测系统
**需求描述**: 专门的车身颜色识别系统

**功能要求**:
- 基于HSV颜色空间的颜色分类
- K-means聚类提取主要颜色
- 支持复合颜色和特殊颜色识别
- 提供颜色置信度评分
- 支持颜色自定义配置

#### 2.2.3 API接口服务
**需求描述**: 提供RESTful API接口供第三方系统集成

**功能要求**:
- 图片上传和标注API
- 搜索和查询API
- 统计信息API
- 批量操作API
- 用户认证和权限控制
- API文档和SDK支持

## 3. 技术需求

### 3.1 技术架构

#### 3.1.1 系统架构
采用分层架构设计，包含以下层次：
- **应用层**: Web界面、API接口
- **业务层**: 标注流水线、数据管理逻辑
- **AI模型层**: SigLIP视觉语言骨干、轻量分类器、颜色检测
- **数据层**: SQLite数据库、文件存储

#### 3.1.2 技术栈选择
**后端技术**:
- Python 3.11+: 主要开发语言
- FastAPI: Web框架，支持异步和API文档
- SQLite: 轻量级数据库，易于部署
- PyTorch: 深度学习框架
- SigLIP: 预训练视觉-语言模型，支持LoRA微调
- OpenCV/PIL: 图像处理库

**前端技术**:
- HTML5/CSS3: 基础前端技术
- Bootstrap 5: 响应式UI框架
- JavaScript: 客户端交互逻辑
- Chart.js: 数据可视化

**AI模型**:
- SigLIP (base patch16): 视觉-语言主干，支持LoRA微调
- EfficientNet / ConvNeXt（备选）: 角度分类对照实验
- YOLOv8: 目标检测（可选扩展）

### 3.2 性能需求

#### 3.2.1 响应时间
- 单张图片AI标注: ≤ 3秒
- 图片列表加载: ≤ 2秒
- 搜索查询响应: ≤ 1秒
- 批量操作（100张图片）: ≤ 5分钟

#### 3.2.2 并发处理
- 支持10个并发用户同时使用
- 支持批量处理1000张图片
- 数据库查询优化（索引、分页）

#### 3.2.3 存储需求
- 图片存储：支持JPG、PNG、WebP格式
- 数据库存储：SQLite文件，支持10万条记录
- 模型存储：PyTorch模型文件，约200MB

### 3.3 兼容性需求

#### 3.3.1 浏览器兼容性
- Chrome 80+
- Firefox 75+
- Safari 13+
- Edge 80+

#### 3.3.2 操作系统兼容性
- Windows 10+
- macOS 10.15+
- Ubuntu 18.04+

### 3.4 安全需求

#### 3.4.1 数据安全
- 图片文件访问控制
- 数据库连接安全
- 敏感信息加密存储

#### 3.4.2 访问控制
- 用户身份认证
- 操作权限管理
- API访问限制

## 4. 数据需求

### 4.1 输入数据

#### 4.1.1 图片数据
**格式要求**:
- 支持格式：JPG、JPEG、PNG、WebP
- 最小分辨率：224x224像素
- 最大文件大小：10MB
- 颜色模式：RGB

**元数据要求**:
- 文件名包含品牌、车型、年份信息（可选）
- EXIF信息保留（拍摄时间、设备信息等）

#### 4.1.2 标注数据
**角度样本数据**:
- 24个角度类别
- 每个角度至少30张样本图片
- 图片质量清晰，角度典型

**品牌样本数据**:
- 8个主要品牌
- 每个品牌包含多个车型
- 覆盖不同年份和款式

### 4.2 输出数据

#### 4.2.1 标注结果
**标注格式**:
```json
{
  "image_id": "img_001",
  "image_path": "/path/to/image.jpg",
  "annotations": {
    "angle": {"label": "1-前45", "confidence": 0.95},
    "brand": {"label": "Honda", "confidence": 0.87},
    "style": {"label": "运动", "confidence": 0.82},
    "color": {"label": "红色", "confidence": 0.91}
  },
  "metadata": {
    "width": 1920,
    "height": 1080,
    "file_size": 2048576,
    "source": "brand_images"
  }
}
```

#### 4.2.2 统计报告
- 标注进度统计
- 准确率分析报告
- 数据分布统计
- 质量评估报告

## 5. 质量需求

### 5.1 准确性要求
- 角度识别准确率 ≥ 95%
- 品牌识别准确率 ≥ 90%
- 风格识别准确率 ≥ 85%
- 颜色识别准确率 ≥ 90%
- 整体系统可用性 ≥ 99%

### 5.2 可靠性要求
- 系统连续运行时间 ≥ 720小时
- 平均故障间隔时间 ≥ 168小时
- 故障恢复时间 ≤ 1小时
- 数据备份和恢复机制

### 5.3 可维护性要求
- 模块化设计，组件独立
- 完整的日志记录系统
- 错误处理和异常管理
- 代码文档覆盖率 ≥ 80%

### 5.4 可扩展性要求
- 支持新品牌和标签的快速添加
- 支持AI模型的热更新
- 支持分布式部署
- 支持插件式功能扩展

## 6. 用户体验需求

### 6.1 易用性要求
- 界面直观，操作简单
- 新用户5分钟内上手
- 提供操作指南和帮助文档
- 支持键盘快捷键操作

### 6.2 交互设计要求
- 响应式设计，适配多设备
- 图片缩略图快速加载
- 实时搜索和筛选
- 批量操作进度显示

### 6.3 视觉设计要求
- 现代化UI设计风格
- 色彩搭配专业美观
- 信息层次清晰
- 支持暗黑模式

## 7. 部署需求

### 7.1 部署环境
- **开发环境**: 本地Python环境
- **测试环境**: Docker容器化部署
- **生产环境**: 云服务器或本地服务器

### 7.2 硬件需求
**最低配置**:
- CPU: 4核心
- 内存: 8GB RAM
- 存储: 100GB SSD
- GPU: 可选（加速AI推理）

**推荐配置**:
- CPU: 16核心
- 内存: 32GB RAM
- 存储: 1TB SSD（NVMe）
- GPU: NVIDIA A5000 移动版（16GB显存）


## 8. 项目交付物

### 8.1 软件交付物
- 完整的源代码
- 训练好的AI模型文件
- 数据库初始化脚本
- 部署配置文件
- Docker镜像文件

### 8.2 文档交付物
- 系统架构设计文档
- API接口文档
- 用户使用手册
- 部署运维指南
- 开发者文档

### 8.3 数据交付物
- 标注样本数据集
- 模型训练数据
- 系统配置数据
- 测试数据集

## 9. 项目计划

### 9.1 开发阶段
**第一阶段 (4天)**: 基础框架搭建
- 项目架构设计
- 数据库设计和实现
- 基础Web框架搭建
- SigLIP骨干集成与推理验证

**第二阶段 (6天)**: 核心功能开发
- AI标注模块开发
- 标注流水线实现
- Web界面开发
- 颜色检测功能

**第三阶段 (4天)**: 高级功能和优化
- 自定义模型训练
- 性能优化
- 用户体验优化
- 系统测试

**第四阶段 (2天)**: 部署和文档
- 系统部署
- 文档编写
- 用户培训
- 项目交付

### 9.2 里程碑节点
- M1: 基础架构完成（第4天）
- M2: 核心功能完成（第10天）
- M3: 系统集成测试完成（第14天）
- M4: 项目正式交付（第16天）

## 10. 风险管理

### 10.1 技术风险
- **AI模型准确率不达标**: 通过数据增强、模型优化、集成学习等方法提升
- **性能瓶颈**: 通过代码优化、硬件升级、分布式部署解决
- **兼容性问题**: 充分测试各种环境和浏览器

### 10.2 数据风险
- **训练数据不足**: 扩大数据收集范围，使用数据增强技术
- **数据质量问题**: 建立数据质量检查流程
- **版权问题**: 确保使用的图片数据合法合规

### 10.3 项目风险
- **需求变更**: 采用敏捷开发方法，及时响应需求变化
- **资源不足**: 合理分配资源，必要时调整项目范围
- **时间延期**: 制定详细的项目计划，定期检查进度

## 11. 验收标准

### 11.1 功能验收
- 所有核心功能正常运行
- AI标注准确率达到指标要求
- Web界面响应正常
- 数据导入导出功能正常

### 11.2 性能验收
- 响应时间符合要求
- 并发处理能力达标
- 系统稳定性良好
- 资源占用合理

### 11.3 质量验收
- 代码质量通过审查
- 文档完整准确
- 测试覆盖率达标
- 安全性检查通过

## 12. 维护和支持

### 12.1 技术支持
- 提供3个月免费技术支持
- 问题响应时间 ≤ 24小时
- 系统更新和维护服务
- 用户培训和咨询服务

### 12.2 系统维护
- 定期备份数据
- 监控系统运行状态
- 及时修复发现的问题
- 根据需求进行功能升级

---

## 附录

### A. 术语表
- **SigLIP**: Sigmoid Loss for Language-Image Pre-training，改进型视觉-语言预训练模型
- **Zero-shot**: 零样本学习，无需额外训练即可识别新类别
- **Ensemble**: 集成学习，组合多个模型提升性能
- **Focal Loss**: 焦点损失，处理类别不平衡的损失函数
- **LoRA**: Low-Rank Adaptation，小规模参数微调方法

### B. 参考资料
- SigLIP论文: "Sigmoid Loss for Language Image Pre-training"
- EfficientNet论文: "EfficientNet: Rethinking Model Scaling for Convolutional Neural Networks"
- FastAPI官方文档: https://fastapi.tiangolo.com/
- PyTorch官方文档: https://pytorch.org/docs/

### C. 技术选型依据
本项目采用的技术栈基于以下考虑：
- **Python**: 丰富的AI库生态，开发效率高
- **SigLIP**: 零样本能力强，兼容LoRA微调以覆盖垂直领域
- **FastAPI**: 现代化Web框架，性能优秀，自动生成API文档
- **SQLite**: 轻量级数据库，易于部署和维护
- **Bootstrap**: 成熟的UI框架，快速构建响应式界面
